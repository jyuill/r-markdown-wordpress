---
title: "Leverage Google Trends in R for Re-usability and Scalability"
author: "`r Sys.getenv('USER')`"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE,
                      message=FALSE,
                      warning=FALSE,
                      fig.height=3,
                      fig.width=5)
options(scipen = 99)
options(digits=3)

library(gtrendsR)
library(tidyverse)
library(scales)
library(lubridate)
library(viridis)
library(here)
```

[Google Trends](https://trends.google.com/trends/) is a popular tool for all manner of curiousity, including serious research, related to trends in search activity on the Google search engine: what topics are trending? what are trends for a given search term? how does this compare to other terms? And lots more.

Google Trends has recently passed its 15th birthday, which promoted folks at Google to write a blog post on ["15 Tips for Getting the Most Out of Google Trends"](https://blog.google/products/search/15-tips-getting-most-out-google-trends/). One thing they noted right at the start is that they used Google Trends to identify search queries related to Google Trends in order to prioritize content for a blog post. This is a classic use case - using Google Trends to fuel content decisions for your marketing.



## Google Trends in R

Google does not provide an official API for Google Trends but the [**gtrendsR**] (https://cran.r-project.org/web/packages/gtrendsR/gtrendsR.pdf) R package created by Philippe Massicotte is a major helper in the accessing Google Trends data within R for reporting and analysis. Along with all the benefits of using R to process and analyze data, the gtrendsR package provides some big advantages over using the Google Trends Interface:

* durability: don't have to fetch the data each time, on-going reference that includes source info.
* re-usability: can re-use the queries already set up in code, share with others.
* scalability: can expand on existing queries, going beyond the limit of 5 that are available in the tool.

## Google Trends Parameters

Google Trends has a number of parameters that can be used to fine-tune your search: date ranges, geo data, categories, Google properties. These are available via the gtrendsR package and they correspond with the options in the Google Trend online interface. You just have to know how to incorporate them:

* **Dates**:
    + "now 1-H": last hour - by MINUTE
    + "now 4-H": last 4 hrs - by MINUTE
    + "now 1-d": last day - every 8 MINUTES
    + "now 7-d": last 7 days - HOURLY data
    + "today 1-m": last 30 days - DAILY data
    + "today 3-m": last 90 days - DAILY data
    + "today 12-m": last 12 months - WEEKLY data
    + "today+5-y": last 5 yrs (default) - WEEKLY data
    + "all" since beginning of Google Trends 2004
    + "YYYY-MM-DD YYYY-MM-DD": custom start / end date - granularity will depend on time spans above
<br />    
* **Geo**:
   + use gtrendsR::countries to see complete list
   + close to 110,000 options, including country / state / city
   + code below shows how to filter for countries
   + **geo=""** for all countries
<br />   
* **Categories**:
    + use gtrendsR::categories
    + over 1,400 categories, with ids that are used in the query
    + **category = 0** for all categories
<br />    
* **Google properies**:
    + specify one or more of 'web', 'news', 'images', 'froogle', 'youtube'
    + gprop=c("web", "youtube") as example for web and youtube search

## Examples

Libraries used:

```{r, echo=TRUE}
library(gtrendsR) ## package for accessing Google Trends
library(tidyverse)
library(lubridate)
library(scales)
library(plotly)
library(gridExtra)

## set default ggplot2 chart theme
theme_set(theme_light())
```

### Example 1

## Additional References

Other useful references for working with gtrendsR and Google Trends:

* [gtrendsR vignette](https://cran.r-project.org/web/packages/gtrendsR/gtrendsR.pdf)
* https://blog.quiet.ly/industry/exploring-google-trends-explore-function-finding-keywords-queries/ 
* https://blog.google/products/search/15-tips-getting-most-out-google-trends/
    + this is the more authoritative and recent blog post


